<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Skin Pack Creator</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        accent: '#52489c',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- JSZip for creating .mcpack (zip) files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

        /* Custom file input button styling with full Tailwind classes */
        .custom-file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: block;
        }
        .custom-file-input {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            cursor: pointer;
            width: 100%;
            height: 100%;
            z-index: 10;
        }

        /* Loading spinner */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid currentColor;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            display: none;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #main-card {
            animation: slideUp 0.8s ease-out forwards;
            opacity: 0;
        }
    </style>
</head>
<body class="font-sans bg-gray-100 dark:bg-gray-900 transition-colors duration-500 text-gray-900 dark:text-gray-100 min-h-screen">
    <div class="p-6 lg:p-12 w-full">
        <div class="flex justify-between items-center mb-10 max-w-6xl mx-auto">
            <h1 class="text-3xl lg:text-4xl font-bold text-accent">Minecraft Skin Pack Creator</h1>
            <button id="theme-toggle" class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors duration-300">
                <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transform transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="display: none;">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
                <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transform transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
            </button>
        </div>

        <div id="main-card" class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-8 lg:p-12 max-w-6xl mx-auto">
            <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-2">Create & Generate Skin Packs</h2>
            <p class="text-gray-600 dark:text-gray-300 mb-8 text-lg">
                Upload your custom skins, set pack details, and generate a Minecraft Bedrock-compatible `.mcpack` file effortlessly.
            </p>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Left Panel: Upload Skins -->
                <div class="flex flex-col">
                    <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-4">Upload Skins</h3>
                    <div class="custom-file-input-wrapper mb-6">
                        <input type="file" id="skin-file-input" accept=".png" multiple class="custom-file-input">
                        <div id="upload-area" class="flex flex-col items-center justify-center p-12 lg:p-16 border-4 border-dashed border-accent rounded-2xl cursor-pointer hover:bg-accent/20 transition-colors duration-300">
                            <i class="fas fa-plus-circle text-2xl text-gray-500 dark:text-gray-400 mb-4"></i> 
                            <span class="text-xl font-bold text-gray-700 dark:text-gray-200">
                                Click or Drag & Drop Skins (PNG)
                            </span>
                            <span class="text-gray-500 dark:text-gray-400 text-center mt-2">
                                Accepted format: .png files. You can select multiple skins at once.
                            </span>
                        </div>
                    </div>

                    <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-4">Uploaded Skins</h3>
                    <div class="bg-gray-200 dark:bg-gray-700 rounded-lg p-4 max-h-96 overflow-y-auto pr-2">
                        <div id="skin-preview-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                            <!-- Skin previews will be injected here -->
                            <p id="no-skins-message" class="col-span-full text-center text-gray-500 dark:text-gray-400 italic">No skins uploaded yet.</p>
                        </div>
                    </div>
                </div>

                <!-- Right Panel: Pack Details & Generate -->
                <div class="flex flex-col">
                    <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-4">Pack Details & Generation</h3>

                    <div class="mb-6">
                        <label for="pack-name-input" class="block text-gray-800 dark:text-gray-100 text-lg font-medium mb-3">Skin Pack Name:</label>
                        <input type="text" id="pack-name-input" class="w-full bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent transition-all duration-200" placeholder="e.g., My Custom Skins">
                    </div>

                    <div class="mb-6">
                        <label for="pack-description-input" class="block text-gray-800 dark:text-gray-100 text-lg font-medium mb-3">Skin Pack Description (Optional):</label>
                        <input type="text" id="pack-description-input" class="w-full bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent transition-all duration-200" placeholder="e.g., A collection of awesome skins!">
                    </div>

                    <div class="mb-6">
                        <label for="author-name-input" class="block text-gray-800 dark:text-gray-100 text-lg font-medium mb-3">Author Name:</label>
                        <input type="text" id="author-name-input" class="w-full bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent transition-all duration-200" placeholder="e.g., Your Name">
                    </div>

                    <div class="mt-auto pt-8">
                        <button id="generate-btn" class="w-full py-4 bg-accent text-white font-bold text-lg rounded-full shadow-lg transform transition-transform duration-300 hover:scale-105 hover:bg-accent/80 flex items-center justify-center gap-3" disabled>
                            Generate .mcpack
                            <i class="fas fa-box-open"></i>
                            <div id="spinner" class="spinner"></div>
                        </button>
                    </div>

                    <!-- Message Box for user feedback -->
                    <div id="message-box" class="hidden p-4 rounded-lg text-center font-medium mt-4" role="alert"></div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const themeToggle = document.getElementById('theme-toggle');
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');
        const skinFileInput = document.getElementById('skin-file-input');
        const skinPreviewGrid = document.getElementById('skin-preview-grid');
        const noSkinsMessage = document.getElementById('no-skins-message');
        const packNameInput = document.getElementById('pack-name-input');
        const packDescriptionInput = document.getElementById('pack-description-input');
        const authorNameInput = document.getElementById('author-name-input');
        const generateButton = document.getElementById('generate-btn');
        const spinner = document.getElementById('spinner');
        const messageBox = document.getElementById('message-box');
        const uploadArea = document.getElementById('upload-area');

        let uploadedSkins = [];

        const languages = {
            "en": "English", "es": "Spanish", "fr": "French", "de": "German", "it": "Italian", "pt": "Portuguese", "ru": "Russian", "ja": "Japanese", "ko": "Korean", "zh-CN": "Chinese (Simplified)", "ar": "Arabic", "hi": "Hindi", "nl": "Dutch", "pl": "Polish", "sv": "Swedish", "tr": "Turkish", "uk": "Ukrainian", "vi": "Vietnamese"
        };
        const minecraftLocales = {
            "en": "en_US", "es": "es_ES", "fr": "fr_FR", "de": "de_DE", "it": "it_IT", "pt": "pt_PT", "ru": "ru_RU", "ja": "ja_JP", "ko": "ko_KR", "zh-CN": "zh_CN", "ar": "ar_SA", "hi": "hi_IN", "nl": "nl_NL", "pl": "pl_PL", "sv": "sv_SE", "tr": "tr_TR", "uk": "uk_UA", "vi": "vi_VN"
        };

        // --- Theme Toggle Functionality ---
        function updateThemeIcons(isDark) {
            if (isDark) {
                sunIcon.style.display = 'block';
                moonIcon.style.display = 'none';
            } else {
                sunIcon.style.display = 'none';
                moonIcon.style.display = 'block';
            }
        }

        const currentTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        if (currentTheme === 'dark') {
            document.documentElement.classList.add('dark');
            updateThemeIcons(true);
        } else {
            updateThemeIcons(false);
        }

        themeToggle.addEventListener('click', () => {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            updateThemeIcons(isDark);
        });

        // --- Message Box Functionality ---
        function showMessage(message, type = 'info') {
            messageBox.textContent = message;
            messageBox.className = "p-4 rounded-lg text-center font-medium mt-4";
            messageBox.classList.remove('hidden');

            if (type === 'error') {
                messageBox.classList.add('bg-red-500', 'text-white');
            } else if (type === 'success') {
                messageBox.classList.add('bg-green-500', 'text-white');
            } else {
                messageBox.classList.add('bg-blue-500', 'text-white');
            }

            setTimeout(() => {
                messageBox.classList.add('hidden');
            }, 5000);
        }

        // --- Helper to read file as Base64 ---
        function readFileAsBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
                reader.readAsDataURL(file);
            });
        }

        function generateUniqueInternalSkinName(displayName, existingSkins, currentSkinId = null) {
            let baseSanitizedName = displayName.toLowerCase().replace(/\s/g, '').replace(/[^a-z0-9]/g, '');
            if (baseSanitizedName === "") {
                baseSanitizedName = "unnamed_skin";
            }
            let uniqueSanitizedName = baseSanitizedName;
            let counter = 1;
            while (existingSkins.some(s => s.id !== currentSkinId && s.internalSkinName === uniqueSanitizedName)) {
                uniqueSanitizedName = `${baseSanitizedName}${counter++}`;
            }
            return uniqueSanitizedName;
        }

        // --- File Input Handling ---
        skinFileInput.addEventListener('change', async (event) => {
            const files = event.target.files;
            if (files.length === 0) {
                showMessage("No files selected.", "info");
                return;
            }
            for (const file of files) {
                if (file.type !== 'image/png') {
                    showMessage(`Skipping "${file.name}": Only PNG images are supported.`, "error");
                    continue;
                }
                if (uploadedSkins.some(skin => skin.file.name === file.name)) {
                    showMessage(`Skipping "${file.name}": A skin with this filename already exists.`, "error");
                    continue;
                }
                try {
                    const base64 = await readFileAsBase64(file);
                    const id = crypto.randomUUID();
                    const defaultDisplayName = file.name.replace(/\.png$/i, '').replace(/[^a-zA-Z0-9_ -]/g, ' ').trim();
                    const internalSkinName = generateUniqueInternalSkinName(defaultDisplayName, uploadedSkins);
                    uploadedSkins.push({ file, base64, id, displayName: defaultDisplayName, internalSkinName: internalSkinName });
                } catch (error) {
                    console.error("Error reading file:", file.name, error);
                    showMessage(`Failed to read "${file.name}".`, "error");
                }
            }
            updateSkinPreviews();
            checkGenerateButtonState();
        });

        // Drag and drop functionality
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            uploadArea.addEventListener(eventName, () => uploadArea.classList.add('bg-accent/20'), false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, () => uploadArea.classList.remove('bg-accent/20'), false);
        });

        uploadArea.addEventListener('drop', handleDrop, false);
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }
        async function handleFiles(files) {
            if (files.length === 0) {
                showMessage("No file(s) selected.", "info");
                return;
            }

            for (const file of files) {
                if (file.type !== 'image/png') {
                    showMessage(`Skipping "${file.name}": Only PNG images are supported.`, "error");
                    continue;
                }
                if (uploadedSkins.some(skin => skin.file.name === file.name)) {
                    showMessage(`Skipping "${file.name}": A skin with this filename already exists.`, "error");
                    continue;
                }
                try {
                    const base64 = await readFileAsBase64(file);
                    const id = crypto.randomUUID();
                    const defaultDisplayName = file.name.replace(/\.png$/i, '').replace(/[^a-zA-Z0-9_ -]/g, ' ').trim();
                    const internalSkinName = generateUniqueInternalSkinName(defaultDisplayName, uploadedSkins);
                    uploadedSkins.push({ file, base64, id, displayName: defaultDisplayName, internalSkinName: internalSkinName });
                } catch (error) {
                    console.error("Error reading file:", file.name, error);
                    showMessage(`Failed to read "${file.name}".`, "error");
                }
            }
            updateSkinPreviews();
            checkGenerateButtonState();
        }

        // --- Update Skin Previews ---
        function updateSkinPreviews() {
            skinPreviewGrid.innerHTML = '';
            if (uploadedSkins.length === 0) {
                noSkinsMessage.classList.remove('hidden');
                skinPreviewGrid.appendChild(noSkinsMessage);
            } else {
                noSkinsMessage.classList.add('hidden');
                uploadedSkins.forEach(skin => {
                    const skinCard = document.createElement('div');
                    skinCard.className = 'bg-gray-100 dark:bg-gray-700 rounded-xl overflow-hidden shadow-lg transition-transform duration-200 hover:scale-105';
                    skinCard.setAttribute('data-id', skin.id);

                    const img = document.createElement('img');
                    img.src = skin.base64;
                    img.alt = skin.file.name;
                    img.className = "w-full h-24 object-contain bg-gray-200 dark:bg-gray-600 border-b-2 border-accent/50";

                    const contentDiv = document.createElement('div');
                    contentDiv.className = 'p-3';

                    const fileNameSpan = document.createElement('span');
                    fileNameSpan.textContent = `File: ${skin.file.name}`;
                    fileNameSpan.classList.add('text-sm', 'text-gray-500', 'dark:text-gray-400', 'truncate', 'block');

                    const nameInput = document.createElement('input');
                    nameInput.type = 'text';
                    nameInput.className = 'w-full bg-gray-200 dark:bg-gray-600 text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-500 rounded-lg p-2 mt-2 text-sm focus:outline-none focus:ring-1 focus:ring-accent transition-all duration-200';
                    nameInput.placeholder = 'Skin Display Name';
                    nameInput.value = skin.displayName;
                    nameInput.setAttribute('data-id', skin.id);
                    nameInput.addEventListener('input', (e) => {
                        const updatedId = e.target.getAttribute('data-id');
                        const targetSkin = uploadedSkins.find(s => s.id === updatedId);
                        if (targetSkin) {
                            targetSkin.displayName = e.target.value.trim();
                            targetSkin.internalSkinName = generateUniqueInternalSkinName(targetSkin.displayName, uploadedSkins, targetSkin.id);
                            checkGenerateButtonState();
                        }
                    });

                    const footer = document.createElement('div');
                    footer.className = 'flex justify-end p-3 border-t border-gray-200 dark:border-gray-700';

                    const removeButton = document.createElement('button');
                    removeButton.className = 'px-3 py-1 bg-red-600 text-white rounded-md text-xs font-semibold transition-transform duration-200 hover:scale-105 hover:bg-red-700';
                    removeButton.innerHTML = '<i class="fas fa-times"></i> Remove';
                    removeButton.title = `Remove ${skin.file.name}`;
                    removeButton.addEventListener('click', () => removeSkin(skin.id));

                    contentDiv.appendChild(fileNameSpan);
                    contentDiv.appendChild(nameInput);
                    footer.appendChild(removeButton);

                    skinCard.appendChild(img);
                    skinCard.appendChild(contentDiv);
                    skinCard.appendChild(footer);
                    skinPreviewGrid.appendChild(skinCard);
                });
            }
        }

        // --- Remove Skin Functionality ---
        function removeSkin(idToRemove) {
            uploadedSkins = uploadedSkins.filter(skin => skin.id !== idToRemove);
            updateSkinPreviews();
            checkGenerateButtonState();
            showMessage("Skin removed.", "info");
        }

        // --- Check Generate Button State ---
        function checkGenerateButtonState() {
            const packName = packNameInput.value.trim();
            const authorName = authorNameInput.value.trim();
            const allSkinsNamed = uploadedSkins.every(skin => skin.displayName && skin.displayName.length > 0);
            generateButton.disabled = !(uploadedSkins.length > 0 && packName.length > 0 && authorName.length > 0 && allSkinsNamed);
        }
        
        packNameInput.addEventListener('input', checkGenerateButtonState);
        authorNameInput.addEventListener('input', checkGenerateButtonState);

        // --- Google Translate API Helper ---
        async function translateText(text, sourceLang, targetLang) {
            if (!text || sourceLang === targetLang) return text;
            const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=${sourceLang}&tl=${targetLang}&dt=t&q=${encodeURIComponent(text)}`;
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.json();
                return data[0][0][0];
            } catch (error) {
                console.error(`Translation failed for "${text}" to ${targetLang}:`, error);
                return text;
            }
        }

        // --- Generate .mcpack Functionality ---
        generateButton.addEventListener('click', async () => {
            const packName = packNameInput.value.trim();
            const packDescription = packDescriptionInput.value.trim();
            const authorName = authorNameInput.value.trim();

            if (!packName || !authorName || uploadedSkins.length === 0 || !uploadedSkins.every(skin => skin.displayName && skin.displayName.length > 0)) {
                showMessage("Please ensure all fields are filled and skins are uploaded.", "error");
                return;
            }

            generateButton.disabled = true;
            spinner.style.display = 'block';
            showMessage("Generating .mcpack...", "info");

            try {
                const zip = new JSZip();

                const packUuidHeader = crypto.randomUUID();
                const packUuidModule = crypto.randomUUID();
                const packSerializeName = packName.toLowerCase().replace(/\s/g, '_').replace(/[^a-z0-9_]/g, '');

                const manifestJson = {
                    "format_version": 1,
                    "header": { "name": `skinpack.${packSerializeName}`, "description": `pack.description.${packSerializeName}`, "uuid": packUuidHeader, "version": [1, 0, 0] },
                    "modules": [{ "type": "skin_pack", "uuid": packUuidModule, "version": [1, 0, 0] }]
                };
                zip.file("manifest.json", JSON.stringify(manifestJson, null, 4));

                const skinsJson = { "serialize_name": packSerializeName, "localization_name": packSerializeName, "skins": [] };
                const textsFolder = zip.folder("texts");
                const defaultSourceLang = "en";

                const stringsToTranslate = new Map();
                stringsToTranslate.set(`skinpack.${packSerializeName}`, packName);
                stringsToTranslate.set(`pack.description.${packSerializeName}`, packDescription || "Custom Minecraft Skin Pack");
                stringsToTranslate.set(`skinpack.${packSerializeName}.by`, authorName);
                uploadedSkins.forEach(skin => { stringsToTranslate.set(`skin.${packSerializeName}.${skin.internalSkinName}`, skin.displayName); });

                const translatedStringsByLang = {};
                for (const targetLangCode in languages) {
                    translatedStringsByLang[targetLangCode] = {};
                    const keysToTranslate = Array.from(stringsToTranslate.keys());
                    const batchSize = 5;

                    for (let i = 0; i < keysToTranslate.length; i += batchSize) {
                        const batchKeys = keysToTranslate.slice(i, i + batchSize);
                        const batchTexts = batchKeys.map(key => stringsToTranslate.get(key));
                        const translatedBatch = await translateText(batchTexts.join('\n'), defaultSourceLang, targetLangCode);
                        if (translatedBatch) {
                            const translatedArray = translatedBatch.split('\n');
                            batchKeys.forEach((key, index) => { translatedStringsByLang[targetLangCode][key] = translatedArray[index] || stringsToTranslate.get(key); });
                        } else {
                            batchKeys.forEach(key => { translatedStringsByLang[targetLangCode][key] = stringsToTranslate.get(key); });
                        }
                        await new Promise(resolve => setTimeout(resolve, 100));
                    }
                }

                for (const skin of uploadedSkins) {
                    const fileName = skin.file.name;
                    const skinLocalizationName = skin.internalSkinName;
                    const response = await fetch(skin.base64);
                    const blob = await response.blob();
                    zip.file(fileName, blob);
                    skinsJson.skins.push({ "localization_name": skinLocalizationName, "geometry": "geometry.humanoid.custom", "texture": fileName, "type": "free" });
                }
                zip.file("skins.json", JSON.stringify(skinsJson, null, 4));

                for (const langCode in languages) {
                    let langFileContent = "";
                    const minecraftLocale = minecraftLocales[langCode] || langCode;
                    langFileContent += `skinpack.${packSerializeName}=${translatedStringsByLang[langCode][`skinpack.${packSerializeName}`]}\n`;
                    langFileContent += `pack.description.${packSerializeName}=${translatedStringsByLang[langCode][`pack.description.${packSerializeName}`]}\n`;
                    langFileContent += `skinpack.${packSerializeName}.by=${translatedStringsByLang[langCode][`skinpack.${packSerializeName}.by`]}\n`;
                    uploadedSkins.forEach(skin => {
                        const skinFullLocalizationKey = `skin.${packSerializeName}.${skin.internalSkinName}`;
                        langFileContent += `${skinFullLocalizationKey}=${translatedStringsByLang[langCode][skinFullLocalizationKey]}\n`;
                    });
                    textsFolder.file(`${minecraftLocale}.lang`, langFileContent);
                }

                const content = await zip.generateAsync({ type: "blob" });
                const downloadLink = document.createElement('a');
                downloadLink.href = URL.createObjectURL(content);
                downloadLink.download = `${packSerializeName}.mcpack`;
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                URL.revokeObjectURL(downloadLink.href);

                showMessage("Skin pack generated successfully! Downloading...", "success");

            } catch (error) {
                console.error("Error generating .mcpack:", error);
                showMessage(`Failed to generate skin pack: ${error.message}. Please check console.`, "error");
            } finally {
                generateButton.disabled = false;
                spinner.style.display = 'none';
            }
        });

        // Initial update
        updateSkinPreviews();
        checkGenerateButtonState();
        
        console.log('Minecraft Skin Pack Creator script loaded successfully.');
    </script>
</body>
</html>
